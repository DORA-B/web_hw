<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta content="width=device-width, initial-scale=1, maximum-scale=1, shrink-to-fit=no" name="viewport">
  <title>æ³¨å†Œ &mdash; 500mlçŸ¿æ³‰æ°´ç“¶</title>

  <!-- General CSS Files -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.8.2/css/all.min.css">
  
  <!-- CSS Libraries -->
  <link rel="stylesheet" href="/theme/malio/assets/modules/selectric/public/selectric.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/select2@4.0.3/dist/css/select2.min.css">

  <!-- Template CSS -->
  <link rel="stylesheet" href="/theme/malio/assets/css/style.css">
  <link rel="stylesheet" href="/theme/malio/assets/css/components.css">

    <!-- Crisp Chat  -->

<script type="text/javascript">
window.$crisp = [];
window.CRISP_WEBSITE_ID = "a1fa9264-647e-4682-a37f-f2f73d238bc8";
CRISP_TOKEN_ID = '';
(function () {
    d = document;
    s = d.createElement("script");
    s.src = "https://client.crisp.chat/l.js";
    s.async = 1;
    d.getElementsByTagName("head")[0].appendChild(s);
})();
</script>  
  
</head>

<body>
  <div id="app">
    <section class="section">
      <div class="container mt-5">
        <div class="row">
          <div class="col-12 col-sm-10 offset-sm-1 col-md-8 offset-md-2 col-lg-8 offset-lg-2 col-xl-8 offset-xl-2">
            <div class="login-brand">
              <img src="/theme/malio/assets/img/stisla-fill.svg" alt="logo" width="100" class="shadow-light rounded-circle">
            </div>

            <div class="card card-primary">
              <div class="card-header">
                <h4>æ³¨å†Œ</h4>
              </div>

              <div class="card-body">
                                <form action="javascript:void(0);" method="POST" class="needs-validation" novalidate="">
                  <div class="row">
                    <div class="form-group col-lg-6 col-sm-12 col-xs-12">
                      <label for="name">æ˜µç§°</label>
                      <input id="name" type="text" class="form-control" name="name" required autofocus>
                      <div class="invalid-feedback">
                        è¯·å¡«å†™æ˜µç§°
                      </div>
                    </div>
                                                                <div class="form-group col-lg-6 col-sm-12 col-xs-12">
                        <label for="email">é‚®ç®±</label>
                        <div class="input-group">
                          <input type="text" id="email" class="form-control col-7" required>
                          <select class="custom-select input-group-append col-5" id="email_postfix" required style="border-top-right-radius: .25rem;
                          border-bottom-right-radius: .25rem;">
                                                                                                                <option value="@gmail.com" selected="">@gmail.com</option>
                                                                                                                                            <option value="@qq.com">@qq.com</option>
                                                                                                                <option value="@outlook.com">@outlook.com</option>
                                                                                                                <option value="@163.com">@163.com</option>
                                                                                                                <option value="@126.com">@126.com</option>
                                                                                                                <option value="@yeah.net">@yeah.net</option>
                                                                                                                <option value="@foxmail.com">@foxmail.com</option>
                                                                                  </select>
                          <div class="invalid-feedback">
                              è¯·å¡«å†™é‚®ç®±
                          </div>
                        </div>
                      </div>
                                          
                                      </div>

                  
                  <div class="row">
                    <div class="form-group col-lg-6 col-sm-12 col-xs-12">
                      <label for="passwd" class="d-block">å¯†ç </label>
                      <input id="passwd" type="password" class="form-control pwstrength" data-indicator="pwindicator" name="passwd" required>
                      <div id="pwindicator" class="pwindicator">
                        <div class="bar"></div>
                        <div class="label"></div>
                      </div>
                      <div class="invalid-feedback">
                        è¯·å¡«å†™å¯†ç 
                      </div>
                    </div>
                    <div class="form-group col-lg-6 col-sm-12 col-xs-12">
                      <label for="repasswd" class="d-block">é‡å¤å¯†ç </label>
                      <input id="repasswd" type="password" class="form-control" name="repasswd" required>
                      <div class="invalid-feedback">
                        è¯·å†æ¬¡å¡«å†™å¯†ç 
                      </div>
                    </div>
                  </div>

                  
                  
                  
                  
                  <div class="form-group">
                    <div class="custom-control custom-checkbox">
                      <input type="checkbox" name="agree" class="custom-control-input" id="agree" checked="checked" required>
                      <label class="custom-control-label" for="agree">æ³¨å†Œå³ä»£è¡¨åŒæ„ <a href="/tos" target="blank">æœåŠ¡æ¡æ¬¾</a></label>
                      <div class="invalid-feedback">
                          è¯·é˜…è¯»æœåŠ¡æ¡æ¬¾å¹¶å‹¾é€‰
                      </div>
                    </div>
                  </div>

                  <div class="form-group">
                    <button id="register-confirm" onclick="doSignUp()" class="btn btn-primary btn-lg btn-block">
                      æ³¨å†Œ
                    </button>
                  </div>
                </form>
                              </div>
            </div>
            <div class="mt-5 text-muted text-center">
                å·²ç»æœ‰è´¦å·äº†ï¼Ÿ <a href="/auth/login">é©¬ä¸Šç™»å½• ğŸ‘‰</a>
              </div>
            <div class="simple-footer">
              Copyright &copy; 2019 500mlçŸ¿æ³‰æ°´ç“¶
              <div class="mt-2">
                Powered by <a href="/staff">SSPANEL</a>
                <div class="bullet"></div>
                Theme by <a href="https://t.me/editXY" target="blank">editXY</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>

  <!-- General JS Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.4/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/tooltip.js@1.3.2/dist/umd/tooltip.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/js/bootstrap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery.nicescroll@3.7.6/jquery.nicescroll.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/moment@2.18.1/min/moment.min.js"></script>

  <!-- JS Libraies -->
  <script src="/theme/malio/assets/modules/jquery-pwstrength/jquery.pwstrength.min.js"></script>
  <script src="/theme/malio/assets/modules/selectric/public/jquery.selectric.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/select2@4.0.3/dist/js/select2.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@7.25.6/dist/sweetalert2.all.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>

  <!-- Page Specific JS File -->
  <script src="/theme/malio/js/malio.js?v16"></script>

  <script>

  $(".pwstrength").pwstrength({
    texts: ['è¶…çº§å¼±é¸¡', 'å¼±é¸¡', 'ä¸€èˆ¬èˆ¬', 'æœ‰ç‚¹å¼º', 'å¾ˆå¼ºğŸ‘Œ'] 
  });

    function login(email,passwd) {
      $.ajax({
          type:"POST",
          url:"/auth/login",
          dataType:"json",
          data:{
              email: email,
              passwd: passwd,
              code: '',
              remember_me: 1
          },
          success: function (data) {
            window.location.assign('/user')
          }
      });
    }

    function register() {
      // vaildation
      if (
        !$("#name").val() ||
        !$("#email").val() ||
        !$("#passwd").val() ||
        !$("#repasswd").val()
        ){
          $('#register-confirm').removeClass("disabled")
          $('#register-confirm').removeAttr("disabled")
        return false
      };
      // eof vaildation
      
      
      code = $("#code").val();
            code = 0;
      if ((getCookie('code')) != '') {
        code = getCookie('code');
      }
      
            var email = $("#email").val()+$("#email_postfix").val();
      
      $.ajax({
          type: "POST",
          url: "/auth/register",
          dataType: "json",
          data: {
              email: email,
              name: $("#name").val(),
              passwd: $("#passwd").val(),
              repasswd: $("#repasswd").val(),
                                          code: code          },
          success: function (data) {
              if (data.ret == 1) {
                swal({
                  type: 'success',
                  title: 'æ³¨å†ŒæˆåŠŸ',
                  showCloseButton: true,
                  onClose: () => {
                    login($("#email").val(), $("#passwd").val());
                  }
                })
              } else {
                $('#register-confirm').removeClass("disabled")
                $('#register-confirm').removeAttr("disabled")
                                $("#code").val(code);
                swal({
                  type: 'error',
                  title: 'æç¤º',
                  showCloseButton: true,
                  text: data.msg
                })
              }
          }
      });
    }

    $("html").keydown(function (event) {
        if (event.keyCode == 13) {
          register()
        }
    });

    function doSignUp(){
      $('#register-confirm').addClass("disabled")
      $('#register-confirm').attr("disabled","disabled")
      register()
    }
  </script>

  
  
  
  
<script>
        function getQueryVariable(variable) {
        var query = window.location.search.substring(1);
        var vars = query.split("&");
        for (var i = 0; i < vars.length; i++) {
            var pair = vars[i].split("=");
            if (pair[0] == variable) {
                return pair[1];
            }
        }
        return "";
    }

        function setCookie(cname, cvalue, exdays) {
        var d = new Date();
        d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
        var expires = "expires=" + d.toGMTString();
        document.cookie = cname + "=" + cvalue + "; " + expires;
    }

        function getCookie(cname) {
        var name = cname + "=";
        var ca = document.cookie.split(';');
        for (var i = 0; i < ca.length; i++) {
            var c = ca[i].trim();
            if (c.indexOf(name) == 0) return c.substring(name.length, c.length);
        }
        return "";
    }

        if (getQueryVariable('code') != '') {
        setCookie('code', getQueryVariable('code'), 30);
        window.location.href = '/auth/register';
    }

    

</script>

</body>

</html>
